Branch 6 coding. Its is modified.